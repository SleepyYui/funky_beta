#!/usr/bin/env fkyrun

open_tcp_server_socket! $fd 8000 1
loop:
  accept! $conn_fd fd
  read! conn_fd $_buf 0x1000
  $reply "
    <html>
    <head>
    <title>Testpage</title>
    </head>
    <body>
    <h1>Testpage</h1>
    <p>This is a testpage.</p>
    </body>
    </html>
  print_to! conn_fd "
    HTTP/1.1 200 OK@cr;
    Content-Type: text/html@cr;
    Content-Length: @(length_of(reply))@cr;
    Connection: close
    @cr;
    @(reply)
  close! conn_fd
  next!
